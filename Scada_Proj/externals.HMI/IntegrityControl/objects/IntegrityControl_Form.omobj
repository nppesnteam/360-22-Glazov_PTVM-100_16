<type access-modifier="public" name="IntegrityControl_Form" display-name="IntegrityControl_Form" uuid="555fc03d-c2a2-4693-b9b3-6d8672bba7cc" base-type="Form" base-type-id="ffaf5544-6200-45f4-87ec-9dd24558a9d5" ver="5" description="">
	<designed target="X" value="0" ver="5"/>
	<designed target="Y" value="0" ver="5"/>
	<designed target="ZValue" value="0" ver="5"/>
	<designed target="Rotation" value="0" ver="5"/>
	<designed target="Scale" value="1" ver="5"/>
	<designed target="Flip" value="0" ver="5"/>
	<designed target="Visible" value="true" ver="5"/>
	<designed target="Opacity" value="1" ver="5"/>
	<designed target="Enabled" value="true" ver="5"/>
	<designed target="Tooltip" value="" ver="5"/>
	<designed target="Width" value="1000" ver="5"/>
	<designed target="Height" value="600" ver="5"/>
	<designed target="PenColor" value="4278190080" ver="5"/>
	<designed target="PenStyle" value="0" ver="5"/>
	<designed target="PenWidth" value="1" ver="5"/>
	<designed target="BrushColor" value="4293980400" ver="5"/>
	<designed target="BrushStyle" value="1" ver="5"/>
	<designed target="WindowX" value="0" ver="5"/>
	<designed target="WindowY" value="0" ver="5"/>
	<designed target="WindowWidth" value="1000" ver="5"/>
	<designed target="WindowHeight" value="600" ver="5"/>
	<designed target="WindowCaption" value="Контроль целостности" ver="5"/>
	<designed target="ShowWindowCaption" value="true" ver="5"/>
	<designed target="ShowWindowMinimize" value="true" ver="5"/>
	<designed target="ShowWindowMaximize" value="true" ver="5"/>
	<designed target="ShowWindowClose" value="true" ver="5"/>
	<designed target="AlwaysOnTop" value="false" ver="5"/>
	<designed target="WindowSizeMode" value="0" ver="5"/>
	<designed target="WindowBorderStyle" value="1" ver="5"/>
	<designed target="WindowState" value="0" ver="5"/>
	<designed target="WindowScalingMode" value="0" ver="5"/>
	<designed target="MonitorNumber" value="0" ver="5"/>
	<designed target="WindowPosition" value="0" ver="5"/>
	<designed target="WindowCloseMode" value="1" ver="5"/>
	<designed target="WindowIconPath" value="IntegrityControl_Icons/IntegrityControl.ico" ver="5"/>
	<object access-modifier="private" name="private" display-name="private" uuid="40799d8d-a042-47a9-a20f-0e2f98c493c2" base-type="" base-type-id="00000000-0000-0000-0000-000000000000" ver="5" description="" cardinal="1">
		<object access-modifier="private" name="restoreWindow" display-name="restoreWindow" uuid="a384eac0-7372-40b1-8524-e573a1593792" base-type="bool" base-type-id="7c9fe1ab-1ee2-42d8-939f-94ce3e89fca8" ver="5" description="" cardinal="1"/>
		<init target="restoreWindow" ver="5" ref="init_RestoreWindow"/>
	</object>
	<object access-modifier="private" name="Debug" display-name="Debug" uuid="65c85036-42e5-425c-bd77-bc6e3d653b0b" base-type="DebugTool" base-type-id="43946044-139a-43f4-a7b8-19a6074ffc56" ver="5"/>
	<object access-modifier="private" name="Toolbar" display-name="Toolbar" uuid="eed9739d-82cc-4cb3-9477-5dc053124533" base-type="Toolbar" base-type-id="5635ccab-cc02-401b-99fa-4b2de84c29dd" ver="5">
		<designed target="X" value="0" ver="5"/>
		<designed target="Y" value="0" ver="5"/>
		<designed target="Rotation" value="0" ver="5"/>
		<designed target="Width" value="1000" ver="5"/>
		<designed target="Height" value="35" ver="5"/>
		<object access-modifier="private" name="SizeLimits" display-name="SizeLimits" uuid="ba885d1c-f915-4e60-9e4f-f05705c85ff5" base-type="LayoutSizeLimits" base-type-id="10342c1f-560b-4160-9de5-7e2c08026f47" ver="5" description="" cardinal="1">
			<designed target="MinWidth" value="0" ver="5"/>
			<designed target="MinHeight" value="0" ver="5"/>
			<designed target="MaxWidth" value="16777215" ver="5"/>
			<designed target="MaxHeight" value="35" ver="5"/>
		</object>
		<init target="pIntegrityControl" ver="5" ref="Workspace.Tree"/>
		<init target="init_Theme" ver="5" ref="here.init_Theme"/>
	</object>
	<object access-modifier="private" name="Workspace" display-name="Workspace" uuid="7b27f947-f592-4a9b-9933-eabc64431eff" base-type="Rectangle" base-type-id="15726dc3-881e-4d8d-b0fa-a8f8237f08ca" ver="5">
		<designed target="X" value="0" ver="5"/>
		<designed target="Y" value="35" ver="5"/>
		<designed target="ZValue" value="0" ver="5"/>
		<designed target="Rotation" value="0" ver="5"/>
		<designed target="Scale" value="1" ver="5"/>
		<designed target="Visible" value="true" ver="5"/>
		<designed target="Opacity" value="1" ver="5"/>
		<designed target="Enabled" value="true" ver="5"/>
		<designed target="Tooltip" value="" ver="5"/>
		<designed target="Width" value="1000" ver="5"/>
		<designed target="Height" value="539" ver="5"/>
		<designed target="RoundingRadius" value="0" ver="5"/>
		<designed target="PenColor" value="0xff000000" ver="5"/>
		<designed target="PenStyle" value="0" ver="5"/>
		<designed target="PenWidth" value="1" ver="5"/>
		<designed target="BrushColor" value="0xff000000" ver="5"/>
		<designed target="BrushStyle" value="0" ver="5"/>
		<object access-modifier="private" name="Tree" display-name="Tree" uuid="56c3441f-7388-4796-815b-e31fa2ea2624" base-type="IntegrityControl" base-type-id="5e8b4ced-3361-4255-ad0a-541497b0ad11" ver="5">
			<designed target="X" value="0" ver="5"/>
			<designed target="Y" value="0" ver="5"/>
			<designed target="Rotation" value="0" ver="5"/>
			<designed target="Width" value="800" ver="5"/>
			<designed target="Height" value="539" ver="5"/>
			<init target="NodeName" ver="5" ref="init_NodeName"/>
			<init target="init_Permissions" ver="5" ref="here.init_Permissions"/>
			<init target="init_Theme" ver="5" ref="here.init_Theme"/>
			<init target="init_ScreenKeyboard" ver="5" ref="here.init_ScreenKeyboard"/>
			<init target="init_Settings" ver="5" ref="here.init_Settings"/>
		</object>
		<object access-modifier="private" name="LinearLayout" display-name="LinearLayout" uuid="59655334-0e59-4363-9273-28f2735f728e" base-type="LinearLayout" base-type-id="800edd71-7303-408c-890b-8346e98f5718" ver="5">
			<designed target="Orientation" value="1" ver="5"/>
			<designed target="Gap" value="0" ver="5"/>
		</object>
		<object access-modifier="private" name="Info" display-name="Info" uuid="15cd867d-37b0-4d20-a8a4-ea5f2c4a346b" base-type="InfoPanel" base-type-id="f83cd7ea-8d09-48ce-9c07-5941768811c3" ver="5">
			<designed target="X" value="800" ver="5"/>
			<designed target="Y" value="0" ver="5"/>
			<designed target="Rotation" value="0" ver="5"/>
			<designed target="Width" value="200" ver="5"/>
			<designed target="Height" value="539" ver="5"/>
			<object access-modifier="private" name="SizeLimits" display-name="SizeLimits" uuid="b566c1da-1d18-452b-8847-3a13e4fdf13c" base-type="LayoutSizeLimits" base-type-id="10342c1f-560b-4160-9de5-7e2c08026f47" ver="5" description="" cardinal="1">
				<designed target="MinWidth" value="0" ver="5"/>
				<designed target="MinHeight" value="0" ver="5"/>
				<designed target="MaxWidth" value="200" ver="5"/>
				<designed target="MaxHeight" value="16777215" ver="5"/>
			</object>
			<init target="pIntegrityControl" ver="5" ref="here.Workspace.Tree"/>
			<init target="init_Theme" ver="5" ref="here.init_Theme"/>
		</object>
		<designed target="Flip" value="0" ver="5"/>
	</object>
	<object access-modifier="private" name="StatusBar" display-name="StatusBar" uuid="e3807545-6e13-4deb-99a8-0b2cbbe61aa8" base-type="Statusbar" base-type-id="fceba724-f999-4d1e-97ba-44d1c0788a88" ver="5">
		<designed target="X" value="0" ver="5"/>
		<designed target="Y" value="575" ver="5"/>
		<designed target="Rotation" value="0" ver="5"/>
		<designed target="Height" value="25" ver="5"/>
		<designed target="Width" value="1000" ver="5"/>
		<object access-modifier="private" name="SizeLimits" display-name="SizeLimits" uuid="73fd4d64-1e46-4a7e-9da4-033880ebf2ee" base-type="LayoutSizeLimits" base-type-id="10342c1f-560b-4160-9de5-7e2c08026f47" ver="5" description="" cardinal="1">
			<designed target="MinWidth" value="0" ver="5"/>
			<designed target="MinHeight" value="0" ver="5"/>
			<designed target="MaxWidth" value="16777215" ver="5"/>
			<designed target="MaxHeight" value="25" ver="5"/>
		</object>
		<object access-modifier="private" name="Margins" display-name="Margins" uuid="b234aec6-45b2-4a39-8f5e-776484e42730" base-type="LayoutMargins" base-type-id="d86ce751-1ea7-42c6-8d4b-10c651a2727d" ver="5" description="" cardinal="1">
			<designed target="Top" value="1" ver="5"/>
			<designed target="Bottom" value="0" ver="5"/>
			<designed target="Left" value="0" ver="5"/>
			<designed target="Right" value="0" ver="5"/>
		</object>
		<init target="pIntegrityControl" ver="5" ref="Workspace.Tree"/>
		<init target="init_Theme" ver="5" ref="here.init_Theme"/>
	</object>
	<object access-modifier="private" name="Layout" display-name="Layout" uuid="82ff8a1d-47eb-4532-aa0e-f1a726964c02" base-type="LinearLayout" base-type-id="800edd71-7303-408c-890b-8346e98f5718" ver="5" description="" cardinal="1">
		<designed target="Orientation" value="2" ver="5"/>
		<designed target="Gap" value="0" ver="5"/>
	</object>
	<do access-modifier="private" name="SaveSession" display-name="SaveSession" ver="5" type="void" type-id="cfbbcafa-e13e-4354-a33a-6e57b818e4da">
		<body kind="javascript">
			<![CDATA[try
{
	var session = 
	{
		"Window": 
		{
			"X": WindowX,
			"Y": WindowY, 
			"Width": WindowWidth,
			"Height": WindowHeight,
			"State": WindowState
		}
	};
	
	var folderPath = Files.ParentPath(filePath);
	if (!Files.Exists(folderPath))
		Files.CreateRecursiveFolder(folderPath);
		
	Files.WriteTextFile(filePath, JSON.stringify(session, null, 2));
}
catch(error)
{
	log("Не удалось сохранить настройки сессии в "  + filePath + ":\n" + error);
}]]>
		</body>
		<param access-modifier="private" name="filePath" display-name="" uuid="8f529d8a-559a-46f3-990e-f326dd8d5743" base-type="string" base-type-id="76403785-f3d5-41a7-9eb6-d19d2aa2d95d" ver="5"/>
	</do>
	<do access-modifier="private" name="LoadSession" display-name="LoadSession" ver="5" type="void" type-id="cfbbcafa-e13e-4354-a33a-6e57b818e4da">
		<body kind="javascript">
			<![CDATA[if (Files.Exists(filePath))
{
	//log("Загрузка настроек из файла "  + filePath);
	try
	{
		var session = JSON.parse(Files.ReadTextFile(filePath));
		
		var window = session.Window;
		if (window != undefined)
		{
			WindowX = window.X;
			WindowY = window.Y;
			WindowWidth = window.Width;
			WindowHeight = window.Height;
			WindowState = window.State;
		}
	}
	catch(error)
	{
		log("Не удалось загрузить настройки сессии из "  + filePath + ":\n" + error);
	}
}]]>
		</body>
		<param access-modifier="private" name="filePath" display-name="" uuid="24b8c0fe-3824-412d-9777-dfb76f3172b1" base-type="string" base-type-id="76403785-f3d5-41a7-9eb6-d19d2aa2d95d" ver="5"/>
	</do>
	<object access-modifier="private" name="Files" display-name="Files" uuid="ed60bbe8-7300-41fb-b1fb-90e9165d0b8e" base-type="FileSystem" base-type-id="34d744f9-7303-4077-a3f7-9c06c0945512" ver="5">
		<designed target="RootPath" value="/" ver="5"/>
	</object>
	<param access-modifier="private" name="init_Theme" display-name="Тема оформления" uuid="5998aaf7-38a8-43d0-a484-896fa30b12a9" base-type="Theme" base-type-id="05d4d7df-0f8e-4ec1-ac85-b5460e30af81" base-const="true" base-ref="true" ver="5"/>
	<param access-modifier="private" name="init_Settings" display-name="Настройки" uuid="13559ed6-5728-455a-9ec4-1a6b4dec15a4" base-type="IntegrityControl_Settings" base-type-id="fc14c85b-e35d-4d4e-9ce0-d35a4b57a1cc" base-const="true" base-ref="true" ver="5" description=""/>
	<param access-modifier="private" name="init_Permissions" display-name="Разрешения" uuid="b1c71501-6fc9-48e8-a4c7-310c31f8fcd6" base-type="IntegrityControl_Permissions" base-type-id="eb3be49d-bd73-4656-be47-fb69e31fffb1" base-const="true" base-ref="true" ver="5" description=""/>
	<param access-modifier="private" name="init_ScreenKeyboard" display-name="Вызов экранной клавиатуры" uuid="c031e7e4-1804-4260-8c0a-3c2d1736402a" base-type="ScreenKeyboardOptions" base-type-id="0589bc8e-fbb2-4f0e-b5d2-f0d825538ef1" base-const="true" base-ref="true" ver="5" description=""/>
	<param access-modifier="private" name="init_NodeName" display-name="Имя узла домена" uuid="29883dc4-b976-4a43-93ca-9215e1589f10" base-type="string" base-type-id="76403785-f3d5-41a7-9eb6-d19d2aa2d95d" ver="5" description=""/>
	<param access-modifier="private" name="init_RestoreWindow" display-name="Восстанавливать положение окна" uuid="d4f01fb6-3103-4a4e-a4dd-79a1d3f3976e" base-type="bool" base-type-id="7c9fe1ab-1ee2-42d8-939f-94ce3e89fca8" ver="5" description=""/>
	<do-on access-modifier="private" name="Handler_1" display-name="Handler_1" ver="5" event="CloseRequested">
		<body kind="om">
			<![CDATA[if (private.restoreWindow)
{
	folderPath: string = unit.ProductInfo.GetUserDataFolder();
	SaveSession(Files.CombinePath(folderPath, "window.json"));
}

Close();]]>
		</body>
	</do-on>
	<do-on access-modifier="private" name="Handler_3" display-name="Handler_3" ver="5" event="WindowSizeChanged">
		<body kind="om">
			<![CDATA[Width = WindowWidth;
Height = WindowHeight;]]>
		</body>
	</do-on>
	<init target="init_RestoreWindow" ver="5" value="false"/>
	<do-on access-modifier="private" name="Handler_4" display-name="Handler_4" ver="5" event="AboutToOpen">
		<body kind="om">
			<![CDATA[if (private.restoreWindow)
{
	folderPath: string = unit.ProductInfo.GetUserDataFolder();
	LoadSession(Files.CombinePath(folderPath, "window.json"));
}

Workspace.Tree.LoadLayout();]]>
		</body>
	</do-on>
	<do-on access-modifier="private" name="Handler_5" display-name="Handler_5" ver="5" event="Closed">
		<body kind="om">
			<![CDATA[Workspace.Tree.SaveLayout();]]>
		</body>
	</do-on>
</type>

