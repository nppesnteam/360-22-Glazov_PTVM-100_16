<type access-modifier="private" name="RoleEdit" display-name="RoleEdit" uuid="01b30c26-46d0-40e6-a364-8a9800f122a0" base-type="Form" base-type-id="ffaf5544-6200-45f4-87ec-9dd24558a9d5" ver="5">
	<designed target="X" value="0" ver="5"/>
	<designed target="Y" value="0" ver="5"/>
	<designed target="ZValue" value="0" ver="5"/>
	<designed target="Rotation" value="0" ver="5"/>
	<designed target="Scale" value="1" ver="5"/>
	<designed target="Visible" value="true" ver="5"/>
	<designed target="Opacity" value="1" ver="5"/>
	<designed target="Enabled" value="true" ver="5"/>
	<designed target="Tooltip" value="" ver="5"/>
	<designed target="Width" value="847" ver="5"/>
	<designed target="Height" value="400" ver="5"/>
	<designed target="PenColor" value="4278190080" ver="5"/>
	<designed target="PenStyle" value="0" ver="5"/>
	<designed target="PenWidth" value="1" ver="5"/>
	<designed target="BrushColor" value="0xfff0f0f0" ver="5"/>
	<designed target="BrushStyle" value="1" ver="5"/>
	<designed target="WindowX" value="0" ver="5"/>
	<designed target="WindowY" value="0" ver="5"/>
	<designed target="WindowWidth" value="847" ver="5"/>
	<designed target="WindowHeight" value="400" ver="5"/>
	<designed target="WindowCaption" value="MainForm" ver="5"/>
	<designed target="ShowWindowCaption" value="true" ver="5"/>
	<designed target="ShowWindowMinimize" value="true" ver="5"/>
	<designed target="ShowWindowMaximize" value="true" ver="5"/>
	<designed target="ShowWindowClose" value="true" ver="5"/>
	<designed target="AlwaysOnTop" value="false" ver="5"/>
	<designed target="WindowSizeMode" value="0" ver="5"/>
	<designed target="WindowBorderStyle" value="1" ver="5"/>
	<designed target="WindowState" value="0" ver="5"/>
	<designed target="WindowScalingMode" value="0" ver="5"/>
	<designed target="MonitorNumber" value="0" ver="5"/>
	<designed target="WindowPosition" value="2" ver="5"/>
	<designed target="WindowCloseMode" value="0" ver="5"/>
	<object access-modifier="private" name="private" display-name="private" uuid="c2fa7987-6771-44b1-b717-5a655538da69" base-type="" base-type-id="00000000-0000-0000-0000-000000000000" ver="5">
		<object access-modifier="private" name="pTheme" display-name="pTheme" uuid="b158af4e-cf90-464e-b99c-f019bfef2b3f" base-type="Theme" base-type-id="05d4d7df-0f8e-4ec1-ac85-b5460e30af81" base-const="true" base-ref="true" ver="5" description=""/>
		<object access-modifier="private" name="pScreenKeyboard" display-name="pScreenKeyboard" uuid="c25a6349-5956-4260-b555-6ec09cab5c66" base-type="ScreenKeyboardOptions" base-type-id="0589bc8e-fbb2-4f0e-b5d2-f0d825538ef1" base-const="true" base-ref="true" ver="5" description=""/>
		<object access-modifier="private" name="SaveChanges" display-name="SaveChanges" uuid="f11050f4-90da-41c9-b5f8-5209642495b1" base-type="notifying_bool" base-type-id="f8797810-1baa-4a1f-af36-cf839bf252e8" ver="5">
			<do-on access-modifier="private" name="Handler_1" display-name="Handler_1" ver="5" event="ValueChanged">
				<body kind="om">
					<![CDATA[if (value)
{
	SystemCommands.DoSave = false;
	Application.Save();
	SystemCommands.GoTo.doBlockingControll();
}]]>
				</body>
			</do-on>
			<object access-modifier="private" name="needSave" display-name="needSave" uuid="18080dbe-7c1f-47d6-b378-df79bed6e271" base-type="notifying_bool" base-type-id="f8797810-1baa-4a1f-af36-cf839bf252e8" ver="5">
				<do-on access-modifier="private" name="Handler_1" display-name="Handler_1" ver="5" event="ValueChanged">
					<body kind="om">
						<![CDATA[SystemCommands.DoSave.CanExecute = value && Application.IsChanged;]]>
					</body>
				</do-on>
			</object>
		</object>
		<object access-modifier="private" name="CreateRole" display-name="CreateRole" uuid="9ca541b2-50e5-47eb-bdcb-712d7d336d79" base-type="notifying_bool" base-type-id="f8797810-1baa-4a1f-af36-cf839bf252e8" ver="5">
			<object access-modifier="private" name="ShowCreateRoleWindow" display-name="ShowCreateRoleWindow" uuid="f819dd7b-322b-43fd-8444-21e3a58853eb" base-type="Action" base-type-id="a9ee9770-1c4a-44c9-b815-157d9fc2ab95" ver="5">
				<designed target="Enabled" value="true" ver="5"/>
				<designed target="InvokeTrigger" value="false" ver="5"/>
				<do-on access-modifier="private" name="Handler_1" display-name="Handler_1" ver="5" event="Invoked" form-action="open-dialog" form-by-id="false">
					<object access-modifier="private" uuid="d34823a5-f32f-4f0e-98cd-e833d06d7099" base-type="InputDialog" base-type-id="eb80f6e6-d9d7-4ca5-a3e9-34863ab130d2" ver="5">
						<init target="Result" ver="5" ref="RoleName"/>
						<init target="OkAction" ver="5" ref="OnComplete"/>
						<designed target="WindowCaption" value="Введите имя роли" ver="5"/>
						<designed target="WindowIconPath" value="Security_Icons/RoleAdd16.png" ver="5"/>
						<init target="init_ScreenKeyboard" ver="5" ref="pScreenKeyboard"/>
						<init target="init_Theme" ver="5" ref="pTheme"/>
					</object>
				</do-on>
			</object>
			<do-on access-modifier="private" name="Handler_1" display-name="Handler_1" ver="5" event="ValueChanged">
				<body kind="om">
					<![CDATA[if (value)
{
	Commands.DoCreate = false;

	RoleName.ClearData();
	WorkPanel.RoleView.SetSelectedRows("[]");
	ShowCreateRoleWindow.Invoke();
}]]>
				</body>
			</do-on>
			<do access-modifier="private" name="AddAllRights" display-name="AddAllRights" ver="5" type="void" type-id="cfbbcafa-e13e-4354-a33a-6e57b818e4da">
				<body kind="javascript">
					<![CDATA[if (roleID == "")
	return;

var appTokenList = JSON.parse(Application.GetTokensList()).data;

if (appTokenList.length > 0)
{
	//формиируем из токена право и добавляем к роли
	for (let token of appTokenList)
	{ 
		let AppName = Application.ApplicationName;
		let TokenType = (token.tokenType == "bool")?(1):(0);
		let TokenName = token.tokenName;
		let TokenValueAllow = (TokenType == 0)?(""):("TRUE"); 
		let TokenValueDeny = (TokenType == 0)?(""):("FALSE");
		Application.RoleAddRight(AppName,roleID, TokenName,TokenType,TokenValueAllow,TokenValueDeny);
	}
}
]]>
				</body>
				<param access-modifier="private" name="roleID" display-name="" uuid="877021b2-68bb-4f79-bd49-042c859e3dd3" base-type="string" base-type-id="76403785-f3d5-41a7-9eb6-d19d2aa2d95d" ver="5"/>
			</do>
			<object access-modifier="private" name="OnComplete" display-name="OnComplete" uuid="14a639ad-8f22-40bb-a914-88001b48e204" base-type="Action" base-type-id="a9ee9770-1c4a-44c9-b815-157d9fc2ab95" ver="5">
				<designed target="Enabled" value="true" ver="5"/>
				<designed target="InvokeTrigger" value="false" ver="5"/>
				<do-on access-modifier="private" name="Handler_1" display-name="Handler_1" ver="5" event="Invoked">
					<body kind="om">
						<![CDATA[if (RoleName.Error == "" && Commands.DoCreate.CanExecute)
{
	Commands.DoCreate.CanExecute = false;
	Application.CreateRole(RoleName.Value, Application.ApplicationID);
	LoadRolesList(Application.GetRolesList());
	currentId: string = WorkPanel.RoleView.GetRoleIdByName(RoleName.Value);
	AddAllRights(currentId);
	Commands.DoCreate.CanExecute = true;
	SaveChanges.needSave = true;
}]]>
					</body>
				</do-on>
			</object>
		</object>
		<object access-modifier="private" name="DeleteRole" display-name="DeleteRole" uuid="7b455fd3-002a-4632-9516-9bd5504b4872" base-type="notifying_bool" base-type-id="f8797810-1baa-4a1f-af36-cf839bf252e8" ver="5">
			<do-on access-modifier="private" name="Handler_1" display-name="Handler_1" ver="5" event="ValueChanged">
				<body kind="om">
					<![CDATA[if (value)
{
	Commands.DoRemoveSelected = false;
	if (private.selectedRoleID != "")
		ShowRemoveDialog.Invoke();
}]]>
				</body>
			</do-on>
			<object access-modifier="private" name="ShowRemoveDialog" display-name="ShowRemoveDialog" uuid="0a4ec015-40e5-4c55-8542-58dbf74f2098" base-type="Action" base-type-id="a9ee9770-1c4a-44c9-b815-157d9fc2ab95" ver="5">
				<designed target="Enabled" value="true" ver="5"/>
				<designed target="InvokeTrigger" value="false" ver="5"/>
				<do-on access-modifier="private" name="Handler_1" display-name="Handler_1" ver="5" event="Invoked" form-action="open-dialog" form-by-id="false">
					<object access-modifier="private" uuid="58436062-27ac-4ccb-b847-a6f7d11b0c50" base-type="MessageDialog" base-type-id="a468f863-f603-4768-ad4b-e16bc34ea78e" ver="5">
						<init target="Icon" ver="5" value="1"/>
						<init target="Buttons" ver="5" value="1"/>
						<designed target="WindowCaption" value="Удалить роль" ver="5"/>
						<init target="OkAction" ver="5" ref="OnComplete"/>
						<init target="Message" ver="5">
							<expr>
								<![CDATA["Вы действительно хотите удалить выбранную роль ?"]]>
							</expr>
						</init>
						<init target="pTheme" ver="5" ref="here.private.pTheme"/>
					</object>
				</do-on>
			</object>
			<object access-modifier="private" name="OnComplete" display-name="OnComplete" uuid="01d194c5-6cf2-4c5d-ad2b-9bc79d427f65" base-type="Action" base-type-id="a9ee9770-1c4a-44c9-b815-157d9fc2ab95" ver="5">
				<designed target="Enabled" value="true" ver="5"/>
				<designed target="InvokeTrigger" value="false" ver="5"/>
				<do-on access-modifier="private" name="Handler_1" display-name="Handler_1" ver="5" event="Invoked">
					<body kind="om">
						<![CDATA[
DeleteAllRighs(private.selectedRoleID);
Application.DeleteRole(private.selectedRoleID);
LoadRolesList(Application.GetRolesList());

private.SaveChanges.needSave = true;
WorkPanel.RoleView.SetSelectedRows("[]");]]>
					</body>
				</do-on>
			</object>
			<do access-modifier="private" name="DeleteAllRighs" display-name="DeleteAllRighs" ver="5" type="void" type-id="cfbbcafa-e13e-4354-a33a-6e57b818e4da">
				<param access-modifier="private" name="roleId" display-name="" uuid="2822a504-0a4a-4eef-a3ba-42236d441d0b" base-type="string" base-type-id="76403785-f3d5-41a7-9eb6-d19d2aa2d95d" ver="5"/>
				<body kind="javascript">
					<![CDATA[var roleRightsList = JSON.parse(Application.GetRoleRights(roleId)).data;
if (roleRightsList.length > 0)
{
	for (let right of roleRightsList)
		Application.RoleDeleteRight(Application.ApplicationName, roleId ,right.tokenName);
}]]>
				</body>
			</do>
		</object>
		<object access-modifier="private" name="ChangeName" display-name="ChangeName" uuid="e88be227-279c-43b9-82cf-7ecc62666f8c" base-type="notifying_bool" base-type-id="f8797810-1baa-4a1f-af36-cf839bf252e8" ver="5">
			<object access-modifier="private" name="ShowChangeNameWindow" display-name="ShowChangeNameWindow" uuid="a75246da-fee1-4438-93b0-a702ade97574" base-type="Action" base-type-id="a9ee9770-1c4a-44c9-b815-157d9fc2ab95" ver="5">
				<designed target="Enabled" value="true" ver="5"/>
				<designed target="InvokeTrigger" value="false" ver="5"/>
				<do-on access-modifier="private" name="Handler_1" display-name="Handler_1" ver="5" event="Invoked" form-action="open-dialog" form-by-id="false">
					<object access-modifier="private" uuid="57a21218-d370-4200-b978-983365f24398" base-type="InputDialog" base-type-id="eb80f6e6-d9d7-4ca5-a3e9-34863ab130d2" ver="5">
						<designed target="WindowCaption" value="Введите имя роли" ver="5"/>
						<init target="Result" ver="5" ref="RoleName"/>
						<init target="OkAction" ver="5" ref="OnComplete"/>
						<designed target="WindowIconPath" value="Security_Icons/RoleRename16.png" ver="5"/>
						<init target="init_ScreenKeyboard" ver="5" ref="pScreenKeyboard"/>
						<init target="init_Theme" ver="5" ref="pTheme"/>
					</object>
				</do-on>
			</object>
			<do-on access-modifier="private" name="Handler_1" display-name="Handler_1" ver="5" event="ValueChanged">
				<body kind="om">
					<![CDATA[if (value)
{
	Commands.DoEdit = false;
	if (selectedRoleID != "")
	{
		RoleName.ClearData();
		RoleName.InputText = selectedRoleName;
		ShowChangeNameWindow.Invoke();
	}
}]]>
				</body>
			</do-on>
			<object access-modifier="private" name="OnComplete" display-name="OnComplete" uuid="8959148b-8e2d-4bfb-813d-12ba87810a40" base-type="Action" base-type-id="a9ee9770-1c4a-44c9-b815-157d9fc2ab95" ver="5">
				<designed target="Enabled" value="true" ver="5"/>
				<designed target="InvokeTrigger" value="false" ver="5"/>
				<do-on access-modifier="private" name="Handler_1" display-name="Handler_1" ver="5" event="Invoked">
					<body kind="om">
						<![CDATA[if (RoleName.Error == "")
{
	SaveChanges.needSave = true;
	Application.ChangeRole(selectedRoleID, RoleName.Value);
	LoadRolesList(Application.GetRolesList());
}]]>
					</body>
				</do-on>
			</object>
		</object>
		<object access-modifier="private" name="selectedRoleID" display-name="selectedRoleID" uuid="fc94cd1d-7572-411b-b17e-c184ecc9ae03" base-type="notifying_string" base-type-id="14976fbf-36ab-415f-abc3-9f8fdc217351" ver="5">
			<do-on access-modifier="private" name="Handler_1" display-name="Handler_1" ver="5" event="ValueChanged">
				<body kind="om">
					<![CDATA[if (value != oldValue)
{
	oldValue = value;
	
	commandsExecuteAbility : bool = (value != "");
	Commands.DoEdit.CanExecute = commandsExecuteAbility;
	Commands.DoRemoveSelected.CanExecute = commandsExecuteAbility;
}]]>
				</body>
			</do-on>
			<object access-modifier="private" name="oldValue" display-name="oldValue" uuid="82fcb1e6-667d-412f-89b2-c2f8e6944ba7" base-type="string" base-type-id="76403785-f3d5-41a7-9eb6-d19d2aa2d95d" ver="5" description="" cardinal="1"/>
		</object>
		<do-trace access-modifier="private" target="CreateRole" ver="5">
			<body>
				<![CDATA[Commands.DoCreate]]>
			</body>
		</do-trace>
		<do-trace access-modifier="private" target="DeleteRole" ver="5">
			<body>
				<![CDATA[Commands.DoRemoveSelected]]>
			</body>
		</do-trace>
		<do-trace access-modifier="private" target="ChangeName" ver="5">
			<body>
				<![CDATA[Commands.DoEdit]]>
			</body>
		</do-trace>
		<do-trace access-modifier="private" target="SaveChanges" ver="5">
			<body>
				<![CDATA[SystemCommands.DoSave]]>
			</body>
		</do-trace>
		<object access-modifier="private" name="selectedRoleName" display-name="selectedRoleName" uuid="a7cf58e1-8313-49c2-a77f-cb90c3456718" base-type="string" base-type-id="76403785-f3d5-41a7-9eb6-d19d2aa2d95d" ver="5"/>
		<object access-modifier="private" name="RoleName" display-name="RoleName" uuid="51bc0a2d-10bf-4789-810b-e1f33c3282e2" base-type="InputDialogResult" base-type-id="cdcda119-652b-45ed-bfc4-8cc21b98730d" ver="5">
			<object access-modifier="private" name="IsChanged" display-name="IsChanged" uuid="541a3f93-4f90-4914-be90-7d671653e840" base-type="notifying_string" base-type-id="14976fbf-36ab-415f-abc3-9f8fdc217351" ver="5">
				<do-on access-modifier="private" name="Handler_1" display-name="Handler_1" ver="5" event="ValueChanged">
					<body kind="javascript">
						<![CDATA[const errorText = RoleName.Error;
const currentRoleName = private.selectedRoleName;

var inputText = InputText.Value.trim();

errorText.Value = "";



if (inputText != "")
{
	//если имя роли не изменилось
	if (currentRoleName.toLowerCase() == inputText.toLowerCase())
		return;

	// Проверка дублирования имён
	var roleList = JSON.parse(Application.GetRolesList()).data;	
	for (let role of roleList)
	{
		if (role.roleName.toLowerCase() == inputText.toLowerCase())
		{
			errorText.Value = "Повторяющиеся имена недопустимы";
			break;
		}
	}
}
else
{
	errorText.Value = "Имя роли не может быть пустым";
}]]>
					</body>
				</do-on>
			</object>
			<do-trace access-modifier="private" target="IsChanged" ver="5">
				<body>
					<![CDATA[InputText]]>
				</body>
			</do-trace>
			<do access-modifier="private" name="ClearData" display-name="ClearData" ver="5" type="void" type-id="cfbbcafa-e13e-4354-a33a-6e57b818e4da">
				<body kind="om">
					<![CDATA[RoleName.InputText = "";
RoleName.Error = "";
RoleName.Value ="";]]>
				</body>
			</do>
		</object>
		<do access-modifier="private" name="UpdateRolesTokenRights" display-name="UpdateRolesTokenRights" ver="5" type="void" type-id="cfbbcafa-e13e-4354-a33a-6e57b818e4da">
			<body kind="javascript">
				<![CDATA[
try
{
	var appTokenList = JSON.parse(Application.GetTokensList()).data;
	var rolesList = JSON.parse(Application.GetRolesList()).data;
}
catch
{
	return;
}

if (rolesList.length != 0)
{
	for (var i = 0; i < rolesList.length; i++ )
	{
		var roleRightsList = JSON.parse(Application.GetRoleRights(rolesList[i].roleID)).data;
		var newRigthsList = [];
		
		//добавляем токены
		if (roleRightsList.length != 0)
		{
			for (let j = 0; j < appTokenList.length; j++)
			{
				if (roleRightsList.findIndex(right => right.tokenName === appTokenList[j].tokenName) == -1)
				{
					newRigthsList.push(appTokenList[j]);
				}
			}
		}
		else
		{
			newRigthsList = appTokenList;
		}
		
		//Формируем права 
		for (var j = 0; j < newRigthsList.length; j++)
		{
			let TokenType = (newRigthsList[j].tokenType == "bool")?(1):(0);
			let TokenValueAllow = (TokenType == 0)?(""):("TRUE"); 
			let TokenValueDeny = (TokenType == 0)?(""):("FALSE");
			Application.RoleAddRight(Application.ApplicationName,rolesList[i].roleID, newRigthsList[j].tokenName, TokenType, TokenValueAllow, TokenValueDeny);
		}
		
		//Удаляем лишние
		for (let j = 0; j < roleRightsList.length; j++)
		{
			if (appTokenList.findIndex(right => right.tokenName === roleRightsList[j].tokenName) == -1)
			{
				Application.RoleDeleteRight(Application.ApplicationName, rolesList[i].roleID, roleRightsList[j].tokenName);
			}
		}
	}
	SystemCommands.GoTo.doBlockingControll();
	Application.Save();
}]]>
			</body>
		</do>
		<do access-modifier="private" name="LoadRolesList" display-name="LoadRolesList" ver="5" type="void" type-id="cfbbcafa-e13e-4354-a33a-6e57b818e4da">
			<body kind="javascript">
				<![CDATA[const rolesModel = WorkPanel.RoleView.TableModel;

WorkPanel.RoleView.Init();
rolesModel.Clear();

var rolesList = JSON.parse(roleListJSON).data;

if (rolesList.length == 0)
	return;

//Заполнение модели
rolesModel.InsertRows(0, rolesList.length);
for (let [row, role] of rolesList.entries())
{
	let rowData = [role.roleID, role.roleName];
	rolesModel.SetRowDataAsJson(row, JSON.stringify(rowData));
}]]>
			</body>
			<param access-modifier="private" name="roleListJSON" display-name="" uuid="506bd925-b75c-48b0-876c-8d6ac441c33a" base-type="string" base-type-id="76403785-f3d5-41a7-9eb6-d19d2aa2d95d" ver="5"/>
		</do>
		<do access-modifier="private" name="SaveViewSettings" display-name="SaveViewSettings" ver="5" type="void" type-id="cfbbcafa-e13e-4354-a33a-6e57b818e4da">
			<body kind="om">
				<![CDATA[SystemCommands.ViewSettings.Update(SystemCommands.Forms.RoleEditor, GetViewSettings());]]>
			</body>
		</do>
		<init target="pTheme" ver="5" ref="init_Theme"/>
		<init target="pScreenKeyboard" ver="5" ref="init_ScreenKeyboard"/>
		<do access-modifier="private" name="UpdateRightsInTable" display-name="UpdateRightsInTable" ver="5" type="void" type-id="cfbbcafa-e13e-4354-a33a-6e57b818e4da">
			<body kind="javascript">
				<![CDATA[//подготовка списка прав для отображения
const roleId = selectedRoleID;

var roleRightsList = JSON.parse(Application.GetRoleRights(roleId)).data;

var rightsEntry = {"Rights": roleRightsList, "EffectiveRights": roleRightsList};

//загрузка прав в таблицу
WorkPanel.RightsTable.ShowRights(JSON.stringify(rightsEntry));]]>
			</body>
		</do>
	</object>
	<object access-modifier="private" name="Debug" display-name="Debug" uuid="954e1ab1-eebd-4f20-a0ae-e0e476a2ddb1" base-type="DebugTool" base-type-id="43946044-139a-43f4-a7b8-19a6074ffc56" ver="5"/>
	<object access-modifier="private" name="Application" display-name="Application" uuid="56d5f2c4-6b8e-4526-b7aa-f0a9bceb78d8" base-type="SecurityManagerApplication" base-type-id="cfc3985c-54fc-4fe4-b001-cade048d6ee0" ver="5">
		<designed target="ApplicationName" value="" ver="5"/>
		<init target="SecurityManager" ver="5">
			<object access-modifier="private" uuid="b0c06c01-d429-4e26-a526-caf2e7df06b8" base-type="SecurityManager" base-type-id="179958e0-f45a-40f3-9668-98e4ea2987da" ver="5">
				<init target="SecurityContext" ver="5">
					<object access-modifier="private" uuid="30f1fe7f-2e62-4f6b-8abb-0191f58ed57a" base-type="SecurityContext" base-type-id="d9cb0fff-b70a-4e2d-833d-3f73cf74e0dd" ver="5"/>
				</init>
			</object>
		</init>
		<do-on access-modifier="private" name="Handler_1" display-name="Handler_1" ver="5" event="LoadComplete">
			<body kind="om">
				<![CDATA[Title.AppNameText = ApplicationName;
private.LoadRolesList(GetRolesList());
private.UpdateRolesTokenRights();
Commands.DoCreate.CanExecute = true;
SystemCommands.GoTo.doUnblockingControll();]]>
			</body>
		</do-on>
		<do-on access-modifier="private" name="Handler_2" display-name="Handler_2" ver="5" event="SaveComplete">
			<body kind="om">
				<![CDATA[private.SaveChanges.needSave = false;
SystemCommands.GoTo = SystemCommands.GoTo.frameCode != SystemCommands.Forms.RoleEditor;
SystemCommands.GoTo.doUnblockingControll();]]>
			</body>
		</do-on>
		<do-on access-modifier="private" name="Handler_3" display-name="Handler_3" ver="5" event="SaveFailed">
			<body kind="om">
				<![CDATA[ShowError.message = GetErrorDescriptionByCode(FailReasonCode);
ShowError.Invoke();
SystemCommands.GoTo.doUnblockingControll();]]>
			</body>
		</do-on>
		<do-on access-modifier="private" name="Handler_4" display-name="Handler_4" ver="5" event="LoadFailed">
			<body kind="om">
				<![CDATA[SystemCommands.GoTo.doUnblockingControll();
ShowError.message = GetErrorDescriptionByCode(FailReasonCode);
ShowError.Invoke();
SystemCommands.GoTo.doUnblockingControll();]]>
			</body>
		</do-on>
	</object>
	<object access-modifier="private" name="inputAppID" display-name="inputAppID" uuid="0eeb669a-4f51-4c33-9961-3c62ebc38c9d" base-type="string" base-type-id="76403785-f3d5-41a7-9eb6-d19d2aa2d95d" ver="5"/>
	<object access-modifier="private" name="Title" display-name="Title" uuid="323f4c00-644b-4d75-8a97-33e5dec35687" base-type="Rectangle" base-type-id="15726dc3-881e-4d8d-b0fa-a8f8237f08ca" ver="5">
		<designed target="X" value="0" ver="5"/>
		<designed target="Y" value="0" ver="5"/>
		<designed target="ZValue" value="0" ver="5"/>
		<designed target="Rotation" value="0" ver="5"/>
		<designed target="Scale" value="1" ver="5"/>
		<designed target="Visible" value="true" ver="5"/>
		<designed target="Opacity" value="1" ver="5"/>
		<designed target="Enabled" value="true" ver="5"/>
		<designed target="Tooltip" value="" ver="5"/>
		<designed target="Width" value="847" ver="5"/>
		<designed target="Height" value="22" ver="5"/>
		<designed target="RoundingRadius" value="0" ver="5"/>
		<designed target="PenColor" value="0xff000000" ver="5"/>
		<designed target="PenStyle" value="0" ver="5"/>
		<designed target="PenWidth" value="1" ver="5"/>
		<designed target="BrushColor" value="0xfff0f0f0" ver="5"/>
		<designed target="BrushStyle" value="0" ver="5"/>
		<do-on access-modifier="private" name="Handler_2" display-name="Handler_2" ver="5" event="MouseRightClick">
			<body kind="javascript">
				<![CDATA[log(Application.GetRolesList());]]>
			</body>
		</do-on>
		<object access-modifier="private" name="Icon" display-name="Icon" uuid="b3ae5109-576a-466e-8c40-155a237c9c2b" base-type="Image" base-type-id="5a6b2782-c728-4a42-8c02-1a83ef97e138" ver="5">
			<designed target="X" value="2" ver="5"/>
			<designed target="Y" value="7" ver="5"/>
			<designed target="ZValue" value="0" ver="5"/>
			<designed target="Rotation" value="0" ver="5"/>
			<designed target="Scale" value="1" ver="5"/>
			<designed target="Visible" value="true" ver="5"/>
			<designed target="Opacity" value="1" ver="5"/>
			<designed target="Enabled" value="true" ver="5"/>
			<designed target="Tooltip" value="" ver="5"/>
			<designed target="Width" value="16" ver="5"/>
			<designed target="Height" value="16" ver="5"/>
			<designed target="PenColor" value="4278190080" ver="5"/>
			<designed target="PenStyle" value="0" ver="5"/>
			<designed target="PenWidth" value="1" ver="5"/>
			<designed target="ImageFile" value="Security_Icons/Application16.png" ver="5"/>
			<designed target="Active" value="true" ver="5"/>
			<designed target="CurrentFrameNumber" value="0" ver="5"/>
			<designed target="Speed" value="1" ver="5"/>
			<object access-modifier="private" name="Margins" display-name="Margins" uuid="e7977459-6046-4ebd-a918-90966b1eaedc" base-type="LayoutMargins" base-type-id="d86ce751-1ea7-42c6-8d4b-10c651a2727d" ver="5" description="" cardinal="1">
				<designed target="Top" value="1" ver="5"/>
				<designed target="Bottom" value="1" ver="5"/>
				<designed target="Left" value="2" ver="5"/>
				<designed target="Right" value="1" ver="5"/>
			</object>
			<object access-modifier="private" name="SizeLimits" display-name="SizeLimits" uuid="455b6c47-37ff-49aa-992d-d657b8a436b1" base-type="LayoutSizeLimits" base-type-id="10342c1f-560b-4160-9de5-7e2c08026f47" ver="5" description="" cardinal="1">
				<designed target="MinWidth" value="0" ver="5"/>
				<designed target="MinHeight" value="0" ver="5"/>
				<designed target="MaxWidth" value="16" ver="5"/>
				<designed target="MaxHeight" value="16" ver="5"/>
			</object>
			<designed target="Flip" value="0" ver="5"/>
		</object>
		<object access-modifier="private" name="AppNameText" display-name="AppNameText" uuid="130f06a1-5433-4dfa-b117-d027687ce3ae" base-type="Text" base-type-id="21d59f8d-2ca4-4592-92ca-b4dc48992a0f" ver="5">
			<designed target="X" value="24" ver="5"/>
			<designed target="Y" value="0" ver="5"/>
			<designed target="ZValue" value="0" ver="5"/>
			<designed target="Rotation" value="0" ver="5"/>
			<designed target="Scale" value="1" ver="5"/>
			<designed target="Visible" value="true" ver="5"/>
			<designed target="Opacity" value="1" ver="5"/>
			<designed target="Enabled" value="true" ver="5"/>
			<designed target="Tooltip" value="" ver="5"/>
			<designed target="Width" value="823" ver="5"/>
			<designed target="Height" value="22" ver="5"/>
			<designed target="Text" value="Приложение" ver="5"/>
			<designed target="Font" value="Tahoma,8,-1,5,50,0,0,0,0,0,Обычный" ver="5"/>
			<designed target="FontColor" value="0xff000000" ver="5"/>
			<designed target="TextAlignment" value="129" ver="5"/>
			<init target="Text" ver="5" value=""/>
			<designed target="Flip" value="0" ver="5"/>
			<object access-modifier="private" name="Margins" display-name="Margins" uuid="7761a0e4-4104-4fc7-b97a-5650cb24186d" base-type="LayoutMargins" base-type-id="d86ce751-1ea7-42c6-8d4b-10c651a2727d" ver="5" description="" cardinal="1">
				<designed target="Top" value="0" ver="5"/>
				<designed target="Bottom" value="0" ver="5"/>
				<designed target="Left" value="5" ver="5"/>
				<designed target="Right" value="0" ver="5"/>
			</object>
			<do-trace access-modifier="private" target="FontColor" ver="5">
				<body>
					<![CDATA[private.pTheme.ForegroundColor]]>
				</body>
			</do-trace>
		</object>
		<object access-modifier="private" name="LinearLayout" display-name="LinearLayout" uuid="7deee29d-0065-4e5f-9adc-8959818e92f5" base-type="LinearLayout" base-type-id="800edd71-7303-408c-890b-8346e98f5718" ver="5">
			<designed target="Orientation" value="1" ver="5"/>
			<designed target="Gap" value="0" ver="5"/>
		</object>
		<object access-modifier="private" name="SizeLimits" display-name="SizeLimits" uuid="45d9c1fd-bb36-4fef-9a15-1c3f56bbacc6" base-type="LayoutSizeLimits" base-type-id="10342c1f-560b-4160-9de5-7e2c08026f47" ver="5" description="" cardinal="1">
			<designed target="MinWidth" value="0" ver="5"/>
			<designed target="MinHeight" value="22" ver="5"/>
			<designed target="MaxWidth" value="16777215" ver="5"/>
			<designed target="MaxHeight" value="22" ver="5"/>
		</object>
		<designed target="Flip" value="0" ver="5"/>
	</object>
	<object access-modifier="private" name="WorkPanel" display-name="WorkPanel" uuid="b86718bc-b0d5-40cc-9434-365c50201758" base-type="Rectangle" base-type-id="15726dc3-881e-4d8d-b0fa-a8f8237f08ca" ver="5" description="" cardinal="1">
		<designed target="X" value="0" ver="5"/>
		<designed target="Y" value="30" ver="5"/>
		<designed target="ZValue" value="0" ver="5"/>
		<designed target="Rotation" value="0" ver="5"/>
		<designed target="Scale" value="1" ver="5"/>
		<designed target="Visible" value="true" ver="5"/>
		<designed target="Opacity" value="1" ver="5"/>
		<designed target="Enabled" value="true" ver="5"/>
		<designed target="Tooltip" value="" ver="5"/>
		<designed target="Width" value="847" ver="5"/>
		<designed target="Height" value="370" ver="5"/>
		<designed target="RoundingRadius" value="0" ver="5"/>
		<designed target="PenColor" value="4278190080" ver="5"/>
		<designed target="PenStyle" value="0" ver="5"/>
		<designed target="PenWidth" value="1" ver="5"/>
		<designed target="BrushColor" value="4278190080" ver="5"/>
		<designed target="BrushStyle" value="0" ver="5"/>
		<object access-modifier="private" name="RoleView" display-name="RoleView" uuid="3b3cdedf-caf3-48fc-be95-01b3a52e979c" base-type="Table" base-type-id="c65ff4dc-f22b-47d3-9333-72c4e4e5f662" ver="5">
			<designed target="X" value="0" ver="5"/>
			<designed target="Y" value="0" ver="5"/>
			<designed target="Rotation" value="0" ver="5"/>
			<designed target="Scale" value="1" ver="5"/>
			<designed target="Visible" value="true" ver="5"/>
			<designed target="Enabled" value="true" ver="5"/>
			<designed target="Width" value="220" ver="5"/>
			<designed target="Height" value="370" ver="5"/>
			<designed target="HeaderHeight" value="25" ver="5"/>
			<designed target="HeaderVisible" value="true" ver="5"/>
			<designed target="RowHeight" value="25" ver="5"/>
			<designed target="RowOrder" value="0" ver="5"/>
			<designed target="SelectionBehavior" value="1" ver="5"/>
			<designed target="SelectionMode" value="1" ver="5"/>
			<designed target="SelectionOverlayEnabled" value="true" ver="5"/>
			<designed target="LatestRowTracking" value="false" ver="5"/>
			<designed target="DelayedSortingEnabled" value="false" ver="5"/>
			<designed target="HorizontalScrollMode" value="0" ver="5"/>
			<designed target="VerticalScrollMode" value="0" ver="5"/>
			<designed target="HorizontalScrollBarPolicy" value="0" ver="5"/>
			<designed target="VerticalScrollBarPolicy" value="0" ver="5"/>
			<object access-modifier="private" name="Column" display-name="Column" uuid="8f4a6d3e-28e8-4050-92a2-e86a2a940e14" base-type="TableColumn" base-type-id="109c05c5-8dcf-4a8f-aedd-5bb547cca2d4" ver="5" cardinal="2">
				<designed target="Title" value="" ver="5"/>
				<designed target="Description" value="" ver="5"/>
				<designed target="Id" value="" ver="5"/>
				<designed target="ColumnOwnId" value="" ver="5"/>
				<designed target="BackgroundColor" value="0xfff0f0f0" ver="5"/>
				<designed target="ForegroundColor" value="0xff000000" ver="5"/>
				<designed target="Font" value="Tahoma,8,-1,5,50,0,0,0,0,0,Обычный" ver="5"/>
				<designed target="TextAlignment" value="129" ver="5"/>
				<designed target="TitleBackgroundColor" value="0xfff0f0f0" ver="5"/>
				<designed target="TitleForegroundColor" value="0xff000000" ver="5"/>
				<designed target="TitleFont" value="Tahoma,8,-1,5,50,0,0,0,0,0,Обычный" ver="5"/>
				<designed target="TitleTextAlignment" value="132" ver="5"/>
				<designed target="Width" value="20" ver="5"/>
				<designed target="WidthResizeMode" value="1" ver="5"/>
				<designed target="Emptiable" value="true" ver="5"/>
				<designed target="Hidden" value="false" ver="5"/>
				<designed target="NumberFormat" value="%g" ver="5"/>
				<designed target="TimeFormat" value="dd.MM.yyyy hh:mm:ss.zzz" ver="5"/>
				<designed target="JsonFilter" value="" ver="5"/>
				<designed target="SortingEnabled" value="false" ver="5"/>
				<designed target="SortOrder" value="0" ver="5"/>
				<designed target="SortPriority" value="0" ver="5"/>
				<designed target="SortMode" value="0" ver="5"/>
				<designed target="WordWrap" value="false" ver="5"/>
				<do-on access-modifier="private" name="Handler_1" display-name="Handler_1" ver="5" event="MouseTitleClick">
					<body kind="om">
						<![CDATA[
// меняем направление сортировки: прямая -> обратная -> отключена и т.д.
if (SortingEnabled)
{
	if (SortOrder == 0)
		SortOrder = 1; // меняем направление сортировки
	else SortingEnabled = false; // отключаем сортировку
}
else
{
	// включаем сортировку
	SortOrder = 0;
	SortingEnabled = true;
}

// сортируем таблицу
ApplySort();
private.SaveViewSettings();]]>
					</body>
				</do-on>
				<do-on access-modifier="private" name="Handler_2" display-name="Handler_2" ver="5" event="WidthChanged">
					<body kind="om">
						<![CDATA[private.SaveViewSettings();]]>
					</body>
				</do-on>
				<do-trace access-modifier="private" target="BackgroundColor" ver="5">
					<body>
						<![CDATA[private.pTheme.EditorBrushColor]]>
					</body>
				</do-trace>
				<do-trace access-modifier="private" target="ForegroundColor" ver="5">
					<body>
						<![CDATA[private.pTheme.EditorFontColor]]>
					</body>
				</do-trace>
				<do-trace access-modifier="private" target="Font" ver="5">
					<body>
						<![CDATA[private.pTheme.Font]]>
					</body>
				</do-trace>
				<do-trace access-modifier="private" target="TitleBackgroundColor" ver="5">
					<body>
						<![CDATA[private.pTheme.BackgroundColor]]>
					</body>
				</do-trace>
				<do-trace access-modifier="private" target="TitleForegroundColor" ver="5">
					<body>
						<![CDATA[private.pTheme.ForegroundColor]]>
					</body>
				</do-trace>
				<do-trace access-modifier="private" target="TitleFont" ver="5">
					<body>
						<![CDATA[private.pTheme.TitleFont]]>
					</body>
				</do-trace>
			</object>
			<init target="TableModel" ver="5" ref="Model"/>
			<do-on access-modifier="private" name="Handler_1" display-name="Handler_1" ver="5" event="CurrentChanged">
				<body kind="om">
					<![CDATA[if (row >= 0 && row < GetRowCount())
{
	rowInModel:int4 = MapRowToModel(row);
	private.selectedRoleID = Variant.ToString(TableModel.GetCellData(rowInModel,0),"");
	private.selectedRoleName = Variant.ToString(TableModel.GetCellData(rowInModel,1),"");
	private.UpdateRightsInTable();
}
else
{
	private.selectedRoleID = "";
	private.selectedRoleName = "";
	WorkPanel.RightsTable.RemoveAllRows();
}]]>
				</body>
			</do-on>
			<designed target="BackgroundColor" value="0xffffffff" ver="5"/>
			<designed target="FrameColor" value="0xff000000" ver="5"/>
			<designed target="GridColor" value="0xffd8d8d8" ver="5"/>
			<object access-modifier="private" name="Model" display-name="Model" uuid="a161a28f-8068-44f4-87ee-edcd0534780c" base-type="TableModel" base-type-id="32b2875b-ee3e-454d-bcbb-40806a49273c" ver="5">
				<designed target="Frozen" value="false" ver="5"/>
				<designed target="MaxRowCount" value="10000" ver="5"/>
				<designed target="OptOfProcessingEvents" value="0" ver="5"/>
			</object>
			<do access-modifier="private" name="Init" display-name="Init" ver="5" type="void" type-id="cfbbcafa-e13e-4354-a33a-6e57b818e4da">
				<body kind="om">
					<![CDATA[if (Model.GetColumnCount() > 0)
	return;
	
//Инициализация таблицы
Column[0].Title = "Id";
Column[0].Id = "roleID";
Column[0].Hidden = true;
Column[0].Width = 20;
	
Column[1].Title = "Роль";
Column[1].Id = "roleName";
Column[1].Hidden = false;
Column[1].Width = 100;
Column[1].SortingEnabled = true;
Column[1].SortOrder = 0;
	
ApplySort();

Model.Reset();
Model.AddColumn("roleID","","","","string",false,true);
Model.AddColumn("roleName","","","","string",false,true);]]>
				</body>
			</do>
			<object access-modifier="private" name="SizeLimits" display-name="SizeLimits" uuid="d672695f-0a47-4202-8548-6d61081b5755" base-type="LayoutSizeLimits" base-type-id="10342c1f-560b-4160-9de5-7e2c08026f47" ver="5" description="" cardinal="1">
				<designed target="MinWidth" value="220" ver="5"/>
				<designed target="MinHeight" value="0" ver="5"/>
				<designed target="MaxWidth" value="220" ver="5"/>
				<designed target="MaxHeight" value="16777215" ver="5"/>
			</object>
			<do access-modifier="private" name="GetRoleIdByName" display-name="GetRoleIdByName" ver="5" type="string" type-id="76403785-f3d5-41a7-9eb6-d19d2aa2d95d">
				<param access-modifier="private" name="roleName" display-name="" uuid="b6c1a9f8-4b71-463d-ba35-29294f93b525" base-type="string" base-type-id="76403785-f3d5-41a7-9eb6-d19d2aa2d95d" ver="5"/>
				<body kind="om">
					<![CDATA[checkedRoleName:string = String.Trim(roleName);
if (checkedRoleName == "")
	return "";

for (row: int4 = 0; row < GetRowCount(); row += 1 )
{
	currentName:string = GetCellData(row, 1);
	if (checkedRoleName == currentName)
	{
		SetCurrentCell(row, 1);
		return GetCellData(row, 0);
	}
}

return "";]]>
				</body>
			</do>
			<do-trace access-modifier="private" target="BackgroundColor" ver="5">
				<body>
					<![CDATA[private.pTheme.EditorBrushColor]]>
				</body>
			</do-trace>
			<do-trace access-modifier="private" target="FrameColor" ver="5">
				<body>
					<![CDATA[private.pTheme.BorderColor]]>
				</body>
			</do-trace>
			<do-trace access-modifier="private" target="GridColor" ver="5">
				<body>
					<![CDATA[private.pTheme.DisabledBorderColor]]>
				</body>
			</do-trace>
			<do-on access-modifier="private" name="Handler_2" display-name="Handler_2" ver="5" event="KeyPress">
				<body kind="om">
					<![CDATA[if (!SystemCommands.GoTo.CanExecute)
	return;

if (keyCode == 110) 				// Insert
	Commands.DoCreate = true;
else if (keyCode == 82) 			// Enter
	Commands.DoEdit = true;
else if (keyCode == 109) 		// Delete
	Commands.DoRemoveSelected = true;]]>
				</body>
			</do-on>
		</object>
		<object access-modifier="private" name="Slider" display-name="Slider" uuid="448642c9-3c3c-475d-9e0e-86e9caa65984" base-type="Rectangle" base-type-id="15726dc3-881e-4d8d-b0fa-a8f8237f08ca" ver="5" description="" cardinal="1">
			<designed target="X" value="220" ver="5"/>
			<designed target="Y" value="0" ver="5"/>
			<designed target="ZValue" value="0" ver="5"/>
			<designed target="Rotation" value="0" ver="5"/>
			<designed target="Scale" value="1" ver="5"/>
			<designed target="Visible" value="true" ver="5"/>
			<designed target="Opacity" value="1" ver="5"/>
			<designed target="Enabled" value="true" ver="5"/>
			<designed target="Tooltip" value="" ver="5"/>
			<designed target="Width" value="4" ver="5"/>
			<designed target="Height" value="378" ver="5"/>
			<designed target="RoundingRadius" value="0" ver="5"/>
			<designed target="PenColor" value="0xff808080" ver="5"/>
			<designed target="PenStyle" value="1" ver="5"/>
			<designed target="PenWidth" value="1" ver="5"/>
			<designed target="BrushColor" value="0xfff0f0f0" ver="5"/>
			<designed target="BrushStyle" value="1" ver="5"/>
			<object access-modifier="private" name="bPressed" display-name="bPressed" uuid="a1b01de5-2720-4a12-86f3-07838a332302" base-type="bool" base-type-id="7c9fe1ab-1ee2-42d8-939f-94ce3e89fca8" ver="5" description="" cardinal="1"/>
			<object access-modifier="private" name="MouseIsOver" display-name="MouseIsOver" uuid="6f821adb-c4a6-411d-aeb7-23b5b95c23ed" base-type="notifying_bool" base-type-id="f8797810-1baa-4a1f-af36-cf839bf252e8" ver="5" description="" cardinal="1"/>
			<do-trace access-modifier="private" target="BrushColor" ver="5">
				<body>
					<![CDATA[MouseIsOver ? private.pTheme.SelectionColor : private.pTheme.BackgroundColor]]>
				</body>
			</do-trace>
			<do-on access-modifier="private" name="Handler_1" display-name="Handler_1" ver="5" event="MouseMove">
				<body kind="om">
					<![CDATA[if (bPressed)
{
	distance: double = Distance + event.X;
	
	min: double = 30;
	if (distance < min)
		distance = min;
		
	max: double = parent.Width - 30;
	if (distance > max)
		distance = max;
	
	if (Distance != distance)
	{
		Distance = distance;
		RoleView.SizeLimits.MinWidth = Distance;
		RoleView.SizeLimits.MaxWidth = Distance;
		private.SaveViewSettings();
	}
}]]>
				</body>
			</do-on>
			<do-on access-modifier="private" name="Handler_2" display-name="Handler_2" ver="5" event="MousePress">
				<body kind="om">
					<![CDATA[bPressed = true;]]>
				</body>
			</do-on>
			<do-on access-modifier="private" name="Handler_3" display-name="Handler_3" ver="5" event="MouseRelease">
				<body kind="om">
					<![CDATA[bPressed = false;]]>
				</body>
			</do-on>
			<do-on access-modifier="private" name="Handler_4" display-name="Handler_4" ver="5" event="MouseEnter">
				<body kind="om">
					<![CDATA[MouseIsOver = true;]]>
				</body>
			</do-on>
			<do-on access-modifier="private" name="Handler_5" display-name="Handler_5" ver="5" event="MouseLeave">
				<body kind="om">
					<![CDATA[MouseIsOver = false;
bPressed = false;]]>
				</body>
			</do-on>
			<object access-modifier="private" name="Distance" display-name="Distance" uuid="30503676-4251-47fc-851f-7adc98c808f1" base-type="double" base-type-id="7ad62ecf-96dd-4751-9b96-e77954b44409" ver="5" description="" cardinal="1"/>
			<init target="Distance" ver="5" value="220"/>
			<designed target="Flip" value="0" ver="5"/>
			<object access-modifier="private" name="SizeLimits" display-name="SizeLimits" uuid="44857aed-ce36-4840-8104-4bcd68432d26" base-type="LayoutSizeLimits" base-type-id="10342c1f-560b-4160-9de5-7e2c08026f47" ver="5" description="" cardinal="1">
				<designed target="MinWidth" value="4" ver="5"/>
				<designed target="MinHeight" value="0" ver="5"/>
				<designed target="MaxWidth" value="4" ver="5"/>
				<designed target="MaxHeight" value="16777215" ver="5"/>
			</object>
			<do-trace access-modifier="private" target="PenColor" ver="5">
				<body>
					<![CDATA[private.pTheme.BorderColor]]>
				</body>
			</do-trace>
		</object>
		<object access-modifier="private" name="LinearLayout" display-name="LinearLayout" uuid="c2490c2a-bd41-40de-858f-fa1573285506" base-type="LinearLayout" base-type-id="800edd71-7303-408c-890b-8346e98f5718" ver="5" description="" cardinal="1">
			<designed target="Orientation" value="1" ver="5"/>
			<designed target="Gap" value="0" ver="5"/>
		</object>
		<object access-modifier="private" name="LayoutWeight" display-name="LayoutWeight" uuid="57bb9d25-d5ed-468b-ad83-7e94d91f0dc9" base-type="LayoutWeight" base-type-id="8f3d975c-9645-4288-9406-a8dda0527008" ver="5" description="" cardinal="1">
			<designed target="Weight" value="1000" ver="5"/>
		</object>
		<object access-modifier="private" name="RightsTable" display-name="RightsTable" uuid="53328810-2d3b-4c77-abb2-6f93184effcd" base-type="RightsTable" base-type-id="e141c390-8852-4e53-874f-a5fe9c888efa" ver="5" description="" cardinal="1">
			<designed target="X" value="224" ver="5"/>
			<designed target="Y" value="0" ver="5"/>
			<designed target="Rotation" value="0" ver="5"/>
			<designed target="Width" value="623" ver="5"/>
			<designed target="Height" value="378" ver="5"/>
			<object access-modifier="private" name="ExchangeDialogData" display-name="ExchangeDialogData" uuid="7cad1704-9286-4a0e-9695-337a567fba31" base-type="ChangedRightsResult" base-type-id="3efb0823-a348-4b39-a762-64290867ccb6" ver="5"/>
			<object access-modifier="private" name="OnViewSettingsChanged" display-name="OnViewSettingsChanged" uuid="563a03e4-ddc8-4b27-86f5-707820224c9b" base-type="Action" base-type-id="a9ee9770-1c4a-44c9-b815-157d9fc2ab95" ver="5" description="" cardinal="1">
				<designed target="Enabled" value="true" ver="5"/>
				<designed target="InvokeTrigger" value="false" ver="5"/>
				<do-on access-modifier="private" name="Handler_1" display-name="Handler_1" ver="5" event="Invoked">
					<body kind="om">
						<![CDATA[here.private.SaveViewSettings();]]>
					</body>
				</do-on>
			</object>
			<object access-modifier="private" name="ChangeRightComplete" display-name="ChangeRightComplete" uuid="f3b0d228-eb27-48af-a534-412b37d7b992" base-type="Action" base-type-id="a9ee9770-1c4a-44c9-b815-157d9fc2ab95" ver="5">
				<designed target="Enabled" value="true" ver="5"/>
				<designed target="InvokeTrigger" value="false" ver="5"/>
				<do-on access-modifier="private" name="Handler_1" display-name="Handler_1" ver="5" event="Invoked">
					<body kind="om">
						<![CDATA[if (ExchangeDialogData.GetDataValidation())
{
	roleId: string = here.private.selectedRoleID;
	here.Application.RoleChangeRight(ExchangeDialogData.App, roleId, ExchangeDialogData.Name, ExchangeDialogData.AllowValue, ExchangeDialogData.DenyValue);
	here.private.UpdateRightsInTable();
	ExchangeDialogData.ResetParamsValues();
	here.private.SaveChanges.needSave = true;
}]]>
					</body>
				</do-on>
			</object>
			<init target="init_Theme" ver="5" ref="here.init_Theme"/>
			<init target="init_ScreenKeyboard" ver="5" ref="here.init_ScreenKeyboard"/>
			<init target="init_ChangedRightsResult" ver="5" ref="ExchangeDialogData"/>
			<init target="pViewSettingsChanged" ver="5" ref="OnViewSettingsChanged"/>
			<init target="EditingAllowed" ver="5" value="true"/>
			<do-trace access-modifier="private" target="EditingAllowed" ver="5">
				<body>
					<![CDATA[pConfigurationAccessValue.Value]]>
				</body>
			</do-trace>
			<init target="pRightValueChanged" ver="5" ref="ChangeRightComplete"/>
		</object>
	</object>
	<object access-modifier="private" name="ShowError" display-name="ShowError" uuid="f753a880-32eb-4bbe-9a2a-edb3624c8173" base-type="Action" base-type-id="a9ee9770-1c4a-44c9-b815-157d9fc2ab95" ver="5">
		<designed target="Enabled" value="true" ver="5"/>
		<designed target="InvokeTrigger" value="false" ver="5"/>
		<do-on access-modifier="private" name="Handler_1" display-name="Handler_1" ver="5" event="Invoked" form-action="open-dialog" form-by-id="false">
			<object access-modifier="private" uuid="223bca99-7570-4708-99ed-c2a06134fdd2" base-type="MessageDialog" base-type-id="a468f863-f603-4768-ad4b-e16bc34ea78e" ver="5">
				<init target="Message" ver="5" ref="message"/>
				<init target="Buttons" ver="5" value="0"/>
				<init target="Icon" ver="5" value="3"/>
				<designed target="WindowCaption" value="Ошибка" ver="5"/>
				<init target="pTheme" ver="5" ref="here.private.pTheme"/>
			</object>
		</do-on>
		<object access-modifier="private" name="message" display-name="message" uuid="07c4ea13-1dd0-486f-b208-307f821cbe98" base-type="string" base-type-id="76403785-f3d5-41a7-9eb6-d19d2aa2d95d" ver="5"/>
	</object>
	<object access-modifier="private" name="Commands" display-name="Commands" uuid="f6306372-45dc-4e9b-96c1-9ca784e69375" base-type="ListCommands" base-type-id="d481f36c-0b94-4338-a60e-3e31bf7df8a1" base-const="true" base-ref="true" ver="5"/>
	<object access-modifier="private" name="SystemCommands" display-name="SystemCommands" uuid="9811db03-cc48-4bab-8cc8-79fdbad1836c" base-type="SystemCommands" base-type-id="0b754dab-38c6-43db-a050-37201965421c" base-const="true" base-ref="true" ver="5"/>
	<designed target="WindowIconPath" value="" ver="5"/>
	<object access-modifier="private" name="pConfigurationAccessValue" display-name="pConfigurationAccessValue" uuid="d32db8c5-e9db-4c53-8dc0-22776d2672c0" base-type="BoolTokenProxy" base-type-id="9cc1c61e-9310-406a-8f93-18028f747d59" base-const="true" base-ref="true" ver="5" description=""/>
	<object access-modifier="private" name="Layout" display-name="Layout" uuid="d0223b7a-6135-4e6a-9eb4-65fa8bb7bce9" base-type="LinearLayout" base-type-id="800edd71-7303-408c-890b-8346e98f5718" ver="5" description="" cardinal="1">
		<designed target="Orientation" value="2" ver="5"/>
		<designed target="Gap" value="0" ver="5"/>
	</object>
	<do access-modifier="private" name="UpdateView" display-name="UpdateView" ver="5" type="void" type-id="cfbbcafa-e13e-4354-a33a-6e57b818e4da">
		<body kind="javascript">
			<![CDATA[var rolesView = WorkPanel.RoleView;
var rightsView = WorkPanel.RightsTable;

var content = JSON.parse(settings);


if (content.Layout != undefined){
	var layout = content.Layout;
	
	rolesView.SizeLimits.MinWidth = layout.RolesTable;
}

let rolesTable = content.RolesTable;
if (rolesTable != undefined)
{
	if (rolesTable.Columns != undefined)
	{
		for (var i = 0; i < rolesView.Column.Length; i++)
		{
			var column = rolesView.Column[i];
			var columnInfo = rolesTable.Columns[column.Id];
			if (columnInfo != undefined)
			{
				column.Width = columnInfo.Width;
				column.Hidden = columnInfo.Hidden;
				column.SortingEnabled = columnInfo.SortOrder != undefined;
				if (column.SortingEnabled)
				{
					column.SortOrder = columnInfo.SortOrder;
					column.SortPriority = columnInfo.SortPriority;
					rolesView.ApplySort();
				}
			}
		}
	}
}
	
let rightsTable = content.RightsTable;
if (rightsTable != undefined)
	rightsView.UpdateView(JSON.stringify(rightsTable));]]>
		</body>
		<param access-modifier="private" name="settings" display-name="" uuid="279aaa64-cae5-45d5-abbc-3c8b53623558" base-type="string" base-type-id="76403785-f3d5-41a7-9eb6-d19d2aa2d95d" ver="5"/>
	</do>
	<do access-modifier="private" name="GetViewSettings" display-name="GetViewSettings" ver="5" type="string" type-id="76403785-f3d5-41a7-9eb6-d19d2aa2d95d">
		<body kind="javascript">
			<![CDATA[var rolesView = WorkPanel.RoleView;
var rightsView = WorkPanel.RightsTable;

var settings = 
	{
		"Layout" : {
			"RolesTable": rolesView.SizeLimits.MinWidth
		},
		"RolesTable" : {
			"Columns":{}
		},
		"RightsTable" : JSON.parse(rightsView.GetViewSettings())
		
	};

for (var i = 0; i < rolesView.Column.Length; i++)
{		
	var column = rolesView.Column[i];
	var columnInfo = {
		"Index": column.Index,
		"Width": column.Width,
		"Hidden": column.Hidden
	};
	if (column.SortingEnabled != false)
	{
		columnInfo.SortOrder = column.SortOrder;
		columnInfo.SortPriority = column.SortPriority;
	}
	
		settings.RolesTable.Columns[column.Id] = columnInfo;
}

return JSON.stringify(settings);]]>
		</body>
	</do>
	<do-on access-modifier="private" name="Handler_2" display-name="Handler_2" ver="5" event="Closed">
		<body kind="om">
			<![CDATA[SystemCommands.DoSave.CanExecute = false;]]>
		</body>
	</do-on>
	<designed target="Flip" value="0" ver="5"/>
	<do-on access-modifier="private" name="Handler_3" display-name="Handler_3" ver="5" event="WindowSizeChanged">
		<body kind="om">
			<![CDATA[Width = WindowWidth;
Height = WindowHeight;]]>
		</body>
	</do-on>
	<param access-modifier="private" name="init_Theme" display-name="init_Theme" uuid="766d4735-3364-49a1-ac80-c73c3094a3cd" base-type="Theme" base-type-id="05d4d7df-0f8e-4ec1-ac85-b5460e30af81" base-const="true" base-ref="true" ver="5" description=""/>
	<do-trace access-modifier="private" target="BrushColor" ver="5">
		<body>
			<![CDATA[private.pTheme.BackgroundColor]]>
		</body>
	</do-trace>
	<do-on access-modifier="private" name="Handler_4" display-name="Handler_4" ver="5" event="AboutToOpen">
		<body kind="om">
			<![CDATA[SystemCommands.GoTo.doBlockingControll();
Application.Load(inputAppID);

WorkPanel.RoleView.Init();

UpdateView(SystemCommands.ViewSettings.Data[SystemCommands.Forms.RoleEditor]);]]>
		</body>
	</do-on>
	<param access-modifier="private" name="init_ScreenKeyboard" display-name="init_ScreenKeyboard" uuid="3c5382a6-74af-4f54-b0d2-6400bfeb1337" base-type="ScreenKeyboardOptions" base-type-id="0589bc8e-fbb2-4f0e-b5d2-f0d825538ef1" base-const="true" base-ref="true" ver="5" description=""/>
</type>

